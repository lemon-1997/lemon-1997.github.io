---
title: "实现go生成curd代码工具——想法由来"
description: "做这个项目的想法"
keywords: "go,generate,tool,代码生成"

publishDate: 2022-09-08T20:25:00+08:00
lastmod: 2022-09-08T20:25:00+08:00

categories:
- 项目实战
tags:
- go
- generate
- sqlboy

toc: false
url: "post/project-sqlboy-1.html"
---

最近写curd写的有点上头，感觉每次都会写一些重复的代码，因此我打算写一个工具，自动生成curd代码，节省时间，减少一些没必要的工作。

<!--more-->

# 忙碌的一周
最近都比较忙，主要精力都放在工作上，所以一直没有更博。这次回来呢，主要是有了一个想法，就是想写一个工具，自动生成data层的curd代码。
因为感觉这些东西都是一些重复性的工作，而且写多了对自己根本没意义，都是一个样，没有技术含量。
另一个原因是wire也是使用过，确实好用，自己想着借这次机会，顺手了解下go中的AST，看看能不能写出好用的东西。

# 调研
有了想法就开始google了，首先是确定有没有类似的东西，能否解决自己的问题。
其中最出名的就是sqlc了，这个也是自动生成代码，不过跟我的初衷有点区别。
我是想通过表结构自动生成curd代码，而sqlc是根据sql语句去生成对应的代码，我想做一个更加简单，方便，一秒钟就可以完成的东西。
这里并不是说sqlc不好，我们的使用场景完全不同。

# sqlboy
我希望的东西其实很简单，我只要新建一个go文件，把表的ddl粘贴进去，选择是sqlx或者gorm，执行命令就能自动生成代码，在项目里就可以调用增删改查分页去操作数据库。
不过，其实还有很多东西要考虑，比如：
1. 文件改了，但是没执行命令，我如何告知使用方
2. 数据库更新时零值忽略的问题，如何提供选项
3. gorm或者sqlx版本问题
4. 。。。。。。。。。

还有很多，这里就不列举出来，有些问题暂时可能没法解决，等后续项目完善再去考虑。
最后给项目起个名字，就叫sqlboy吧！

# 预告
后续博客更新的内容为：AST读取，ddl解析

# 写在结尾
vercel被墙，害我把博客又搬到cloudfare，现在waline评论国内不能用了，寄。